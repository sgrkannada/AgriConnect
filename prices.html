<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KrishiMandi - Live Mandi Prices</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="app-header">
        <div class="container">
            <a href="index.html" class="logo">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.58 9.55c-1.84-3.53-5.02-6.11-8.8-6.53-2.2-.25-4.44.2-6.39 1.28-1.95 1.08-3.51 2.76-4.48 4.79-.31.65-.21 1.41.24 1.95.45.54 1.2.75 1.86.54.66-.21 1.11-.82.9-1.48.79-1.67 2.06-3.03 3.65-3.87 1.59-.84 3.42-1.16 5.25-.9 3.03.43 5.61 2.5 6.96 5.11.39.75 1.22 1.13 2 .85.78-.28 1.25-1.08.97-1.85zM2.42 14.45c1.84 3.53 5.02 6.11 8.8 6.53 2.2.25 4.44-.2 6.39-1.28 1.95-1.08 3.51 2.76 4.48-4.79.31-.65.21-1.41-.24-1.95-.45-.54-1.2-.75-1.86-.54-.66-.21-1.11.82-.9 1.48-.79 1.67-2.06 3.03-3.65 3.87-1.59-.84-3.42-1.16-5.25.9-3.03-.43-5.61-2.5-6.96-5.11-.39-.75-1.22-1.13-2-.85-.78.28-1.25-1.08-.97 1.85z" fill="#2ECC71"></path></svg>
                <h1>KrishiMandi</h1>
            </a>
             <nav class="main-nav">
                <a href="prices.html" class="active">Prices</a>
                <a href="buy.html">Buy</a>
                <a href="sell.html">Sell</a>
                <a href="diagnose.html">Diagnose</a>
                <a href="shop.html">Shop</a>
                <a href="insurance.html">Insurance</a>
                <a href="tasks.html">Tasks</a>
                <a href="reels.html">Reels</a>
            </nav>
        </div>
    </header>

    <main>
        <section id="mandi-prices" class="app-section">
            <div class="container reveal">
                <div class="section-header">
                    <h3>Live Mandi Prices</h3>
                    <div class="header-meta">
                        <span id="price-timestamp">ðŸ•’ Updated: 06:18 PM</span>
                        <span><span class="live-dot"></span> Live</span>
                        <button id="refresh-prices-btn" class="btn-refresh">Refresh</button>
                    </div>
                </div>
                <div id="mandi-prices-grid" class="card-grid">
                    <!-- Price cards will be dynamically inserted here -->
                </div>
            </div>
        </section>
    </main>

    <div id="toast-container"></div>
    <footer class="app-footer">
        <div class="container">
            <p>&copy; 2025 KrishiMandi. All rights reserved.</p>
        </div>
    </footer>

    <script type="module">
        document.addEventListener('DOMContentLoaded', () => {
            function showToast(message, type = 'success') {
                const toastContainer = document.getElementById('toast-container');
                if (!toastContainer) {
                    const container = document.createElement('div');
                    container.id = 'toast-container';
                    document.body.appendChild(container);
                }
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.getElementById('toast-container').appendChild(toast);
                setTimeout(() => { toast.remove(); }, 5000);
            }

            const header = document.querySelector('.app-header');
            window.addEventListener('scroll', () => header.classList.toggle('scrolled', window.scrollY > 50));

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('visible');
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

            const refreshPricesBtn = document.getElementById('refresh-prices-btn');
            const pricesGrid = document.getElementById('mandi-prices-grid');
            const priceTimestamp = document.getElementById('price-timestamp');

            const initialPrices = [
                { name: 'Wheat', price: 2463.48, change: 1.1, min: 2200, max: 2680, market: 'Delhi' },
                { name: 'Rice', price: 3073.28, change: -0.5, min: 2980, max: 3350, market: 'Mumbai' },
                { name: 'Sugarcane', price: 398.98, change: 4.1, min: 350, max: 420, market: 'Pune' },
                { name: 'Cotton', price: 7005.43, change: 2.0, min: 6200, max: 7100, market: 'Nagpur' },
                { name: 'Mustard', price: 5450.10, change: -1.2, min: 5100, max: 5800, market: 'Jaipur' },
                { name: 'Soybean', price: 4350.50, change: 3.5, min: 4100, max: 4600, market: 'Indore' },
            ];

            function renderPrices(priceData) {
                pricesGrid.innerHTML = '';
                priceData.forEach(item => {
                    const changeClass = item.change >= 0 ? 'positive' : 'negative';
                    const changeSign = item.change >= 0 ? '+' : '';
                    pricesGrid.innerHTML += `
                        <div class="card price-card">
                            <h4>${item.name}</h4>
                            <div class="price-value">â‚¹${item.price.toFixed(2)} <span class="change ${changeClass}">${changeSign}${item.change}%</span></div>
                            <div class="price-meta">per quintal</div>
                            <div class="price-details">
                                <span>Min: <strong>â‚¹${item.min}</strong></span>
                                <span>Max: <strong>â‚¹${item.max}</strong></span>
                                <span>Market: <strong>${item.market}</strong></span>
                            </div>
                        </div>`;
                });
            }

            refreshPricesBtn.addEventListener('click', () => {
                pricesGrid.innerHTML = '<div class="loader"></div>';
                setTimeout(() => {
                    const newPrices = initialPrices.map(p => ({...p, price: p.price * (1 + (Math.random() - 0.5) * 0.1) }));
                    renderPrices(newPrices);
                    const now = new Date();
                    priceTimestamp.textContent = `ðŸ•’ Updated: ${now.toLocaleTimeString('en-US', { hour: '2-digit', minute:'2-digit' })}`;
                    showToast('Prices updated successfully!');
                }, 1500);
            });

            renderPrices(initialPrices);
        });
    </script>
</body>
</html>
